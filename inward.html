<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Salasar Paper Converter - ERP Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <style>
        /* styles.css */

.modal-overlay {
    position: fixed; /* Fixes the modal to the viewport */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.6); /* Semi-transparent black background */
    display: flex; /* Use flexbox for centering */
    justify-content: center; /* Center horizontally */
    align-items: center; /* Center vertically */
    z-index: 1000; /* Ensure it's on top of other content */
    opacity: 1; /* Make it visible when active */
    transition: opacity 0.3s ease-in-out; /* Smooth transition */
}

.modal-overlay.hidden {
    opacity: 0; /* Hidden state */
    pointer-events: none; /* Prevents interaction when hidden */
}

.modal-content {
    background-color: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    max-width: 90%; /* Adjust as needed */
    width: 600px; /* Or a specific width */
    max-height: 90vh; /* Max height for scrollable content */
    overflow-y: auto; /* Enable scrolling for long content */
    position: relative; /* Needed for z-index or if you add absolute children */
    z-index: 1001; /* Ensure content is above the overlay background */
    transform: translateY(0); /* Initial state for animation */
    transition: transform 0.3s ease-in-out; /* Smooth transition */
}

.modal-overlay.hidden .modal-content {
    transform: translateY(-20px); /* Move content up slightly when hidden */
}

/* Custom styles for the searchable dropdown (Supplier field) */
.custom-select-wrapper {
    position: relative;
}

.custom-select-options {
    position: absolute;
    top: 100%; /* Position below the input */
    left: 0;
    right: 0;
    z-index: 10; /* Ensure it's above other form elements */
    background-color: white;
    border: 1px solid #e2e8f0; /* gray-200 */
    border-radius: 0.5rem; /* rounded-lg */
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* shadow-md */
    max-height: 200px; /* Limit height for scrollability */
    overflow-y: auto; /* Enable scrolling */
    display: none; /* Hidden by default */
}

.custom-select-option {
    padding: 0.5rem 0.75rem; /* px-3 py-2 */
    cursor: pointer;
    font-size: 0.875rem; /* text-sm */
    color: #4a5568; /* gray-700 */
}

.custom-select-option:hover {
    background-color: #f7fafc; /* gray-50 */
    color: #2d3748; /* gray-800 */
}

.custom-select-option.add-new {
    font-weight: 600; /* font-semibold */
    color: #4299e1; /* blue-500 */
    border-top: 1px solid #e2e8f0; /* Separator for "add new" */
}

.custom-select-option.add-new:hover {
    background-color: #ebf8ff; /* blue-50 */
}

/* New: Hover effects for nav links */
.nav-link {
    padding: 0.5rem 0.75rem; /* Equivalent to px-3 py-2 */
    border-radius: 0.375rem; /* Equivalent to rounded-md */
    transition: background-color 0.2s, color 0.2s; /* Smooth transition */
}

.nav-link:hover {
    background-color: #eff6ff; /* blue-50 */
    color: #2563eb; /* blue-600 */
}

.mobile-nav-link {
    transition: background-color 0.2s; /* Smooth transition */
}
.mobile-nav-link:hover {
    background-color: #f7fafc; /* gray-100 */
}

.nav-link.active {
        background-color: #e0f2fe; /* blue-50 */
        color: #2563eb; /* blue-600 */
        font-weight: 600; /* font-semibold */
    }

    </style>
</head>
<body>

    <div class="header-fixed w-full border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3">
            <div class="flex justify-between items-center">
                <div class="flex items-center">
                    <i class="fas fa-file-invoice text-blue-600 text-2xl mr-3"></i>
                    <h1 class="text-xl font-semibold text-gray-800 whitespace-nowrap shrink-0">Salasar Paper Converter</h1>
                </div>
                <nav class="desktop-nav flex items-center space-x-2 ml-8">
                    <a href="index.html" class="nav-link font-medium">Dashboard</a>
                    <a href="inward.html" class="nav-link font-medium">Inward</a>
                    <a href="cutting.html" class="nav-link font-medium">Cutting</a>
                    <a href="wrapping.html" class="nav-link font-medium">Wrapping</a>
                    <a href="warehousing.html" class="nav-link font-medium">Sifting/Staging</a>
                    <a href="compliance.html" class="nav-link font-medium">Breakdown</a>
                    <a href="accounts.html" class="nav-link font-medium">Accounts</a>
                </nav>

                <div class="flex items-center space-x-4">
                    <!-- Removed mobile menu button -->

                    <div class="relative">
                        <button id="notificationBtn" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-bell"></i>
                        </button>
                        <span class="absolute top-0 right-0 h-2 w-2 rounded-full bg-red-500"></span>
                    </div>
                    <div class="relative">
                        <button id="userMenuBtn" class="flex items-center space-x-2 text-gray-700 hover:text-gray-900">
                            <span class="hidden md:block font-medium">Admin</span>
                            <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                        <div id="userMenu" class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-20 hidden">
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Profile</a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Settings</a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Sign out</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Removed mobile menu div -->

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
        <div class="bg-white rounded-lg shadow-sm p-4">
            <div class="flex items-center">
                <div class="rounded-full bg-blue-100 p-3 mr-4">
                    <i class="fas fa-boxes text-blue-600"></i>
                </div>
                <div>
                    <p class="text-sm text-gray-500">Total Inward</p>
                    <p id="totalInwardCount" class="text-xl font-semibold">0 Reels</p>
                </div>
            </div>
        </div>
        <div class="bg-white rounded-lg shadow-sm p-4">
            <div class="flex items-center">
                <div class="rounded-full bg-green-100 p-3 mr-4">
                    <i class="fas fa-check-circle text-green-600"></i>
                </div>
                <div>
                    <p class="text-sm text-gray-500">Processed (Valid)</p>
                    <p id="processedCount" class="text-xl font-semibold">0 Reels</p>
                </div>
            </div>
        </div>
        <div class="bg-white rounded-lg shadow-sm p-4">
            <div class="flex items-center">
                <div class="rounded-full bg-yellow-100 p-3 mr-4">
                    <i class="fas fa-clock text-yellow-600"></i>
                </div>
                <div>
                    <p class="text-sm text-gray-500">Pending</p>
                    <p id="pendingCount" class="text-xl font-semibold">0 Reels</p>
                </div>
            </div>
        </div>
        <div class="bg-white rounded-lg shadow-sm p-4">
            <div class="flex items-center">
                <div class="rounded-full bg-red-100 p-3 mr-4">
                    <i class="fas fa-times-circle text-red-600"></i>
                </div>
                <div>
                    <p class="text-sm text-gray-500">In-Valid</p>
                    <p id="invalidCount" class="text-xl font-semibold">0 Reels</p>
                </div>
            </div>
        </div>
    </div>

    <!-- The "New Inward Entry" form will now be in a modal -->
    <div class="bg-white rounded-lg shadow-sm">
        <div class="p-4 border-b border-gray-200 flex justify-between items-center">
            <h2 class="text-lg font-semibold text-gray-800">Recent Inward Records</h2>
            <div class="flex items-center space-x-2">
                <button id="addInwardButton" class="px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center">
                    <i class="fas fa-plus mr-2"></i>
                    Add Inward
                </button>
                <button class="px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 flex items-center">
                    <i class="fas fa-filter mr-2"></i>
                    Filter
                </button>
                <button class="px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 flex items-center">
                    <i class="fas fa-download mr-2"></i>
                    Export
                </button>
            </div>
        </div>
        <div class="table-container">
            <div class="overflow-x-auto">
                <table class="w-full" id="inwardRecordsTable">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date of Inward</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Reel Code</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Weight (kg)</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">To be proceed for</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Supplier</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Material Type</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Remarks</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th> <!-- New Status Header -->
                            <th class="px-4 py-3 whitespace-nowrap text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Action</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <!-- Table rows will be dynamically inserted here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
        <div class="p-4 border-t border-gray-200">
            <div class="flex items-center justify-between">
                <div class="text-sm text-gray-500">
                    Showing 1 to 10 of <span id="totalEntries">0</span> entries
                </div>
                <div class="flex space-x-2">
                    <button class="px-3 py-1 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50">
                        Previous
                    </button>
                    <button class="px-3 py-1 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                        Next
                    </button>
                </div>
            </div>
        </div>
    </div>
</main>

<footer class="bg-white border-t border-gray-200 mt-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
        <div class="flex flex-col md:flex-row justify-between items-center">
            <p class="text-sm text-gray-500">Â© 2025 Salasar Paper Converter. All rights reserved.</p>
            <div class="flex space-x-4 mt-4 md:mt-0">
                <a href="#" class="text-sm text-gray-500 hover:text-gray-700">Help Center</a>
                <a href="#" class="text-sm text-gray-500 hover:text-gray-700">Documentation</a>
                <a href="#" class="text-sm text-gray-500 hover:text-gray-700">Contact Support</a>
            </div>
        </div>
    </div>
</footer>

<!-- Modal for New Inward Entry Form -->
<div id="inwardEntryModal" class="modal-overlay hidden">
    <div class="modal-content">
        <div class="flex justify-between items-center border-b border-gray-200 pb-3 mb-4">
            <h2 class="text-lg font-semibold text-gray-800" id="inwardModalTitle">New Inward Entry</h2>
            <button id="closeModalButton" class="text-gray-500 hover:text-gray-700">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>
        <form class="p-4" id="newInwardForm">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Date of Inward</label>
                    <input type="date" name="inwardDate" id="inwardDateModal" required readonly
                        class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-100 cursor-not-allowed">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Reel Code</label>
                    <input type="text" name="reelCode" id="reelCodeModal" required
                        class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Weight (kg)</label>
                    <input type="number" name="weight" id="weightModal" required
                        class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">To be proceed for</label>
                    <select name="zone" id="zoneModal" required
                        class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">Select Zone</option>
                        <option value="Cutting">Cutting</option>
                        <option value="Wrapping">Wrapping</option>
                    </select>
                </div>
                <!-- Supplier Searchable Dropdown -->
                <div class="custom-select-wrapper">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Supplier</label>
                    <input type="text" id="supplierSearchInput" placeholder="Search or Add Supplier"
                        class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <input type="hidden" name="supplier" id="supplierHiddenInput">
                    <div id="supplierOptions" class="custom-select-options">
                        <!-- Options will be dynamically loaded here -->
                    </div>
                </div>
                <!-- Material Type Searchable Dropdown -->
                <div class="custom-select-wrapper">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Material Type</label>
                    <input type="text" id="materialTypeSearchInput" placeholder="Search or Add Material Type"
                        class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <input type="hidden" name="materialType" id="materialTypeHiddenInput">
                    <div id="materialTypeOptions" class="custom-select-options">
                        <!-- Options will be dynamically loaded here -->
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Width (cm)</label>
                    <input type="number" name="widthCm" id="widthCmModal"
                        class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Diameter (cm)</label>
                    <input type="number" name="diameterCm" id="diameterCmModal"
                        class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div class="md:col-span-2">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Remarks</label>
                    <textarea name="remarks" rows="3" id="remarksModal"
                        class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                </div>
            </div>
            <div class="mt-4 flex justify-end">
                <button type="submit" id="submitInwardFormButton"
                    class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center">
                    <i class="fas fa-plus mr-2"></i> Create Entry
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Modal for Viewing Inward Entry Details -->
<div id="viewDetailsModal" class="modal-overlay hidden">
    <div class="modal-content">
        <!-- Header -->
        <div class="flex justify-between items-center border-b border-gray-200 px-6 py-4">
            <h2 class="text-xl font-semibold text-gray-800">Inward Entry Details</h2>
            <!-- Vertical Separator and Reel Code (moved to header) -->
            <div class="flex items-center space-x-3 ml-auto">
                <div class="hidden md:block h-8 border-l border-gray-300"></div> <!-- Vertical Line -->
                <div class="flex items-center ml-3">
                    <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center mr-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                    </div>
                    <span id="detailReelCode" class="text-xl font-semibold text-blue-700"></span>
                </div>
            </div>
            <button id="closeViewModalButton" class="text-gray-500 hover:text-gray-700">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>
        <!-- Details Body -->
        <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-y-4 gap-x-6 text-gray-700">
            <div>
                <p class="text-sm font-medium text-gray-500">Date of Inward:</p>
                <p id="detailInwardDate" class="font-semibold"></p>
            </div>
            <div>
                <p class="text-sm font-medium text-gray-500">Weight (kg):</p>
                <p id="detailWeight" class="font-semibold"></p>
            </div>
            <div>
                <p class="text-sm font-medium text-gray-500">To be Proceed For:</p>
                <p id="detailZone" class="font-semibold"></p>
            </div>
            <div>
                <p class="text-sm font-medium text-gray-500">Supplier:</p>
                <p id="detailSupplier" class="font-semibold"></p>
            </div>
            <div>
                <p class="text-sm font-medium text-gray-500">Material Type:</p>
                <p id="detailMaterialType" class="font-semibold"></p>
            </div>
            <div>
                <p class="text-sm font-medium text-gray-500">Width (cm):</p>
                <p id="detailWidthCm" class="font-semibold"></p>
            </div>
            <div>
                <p class="text-sm font-medium text-gray-500">Diameter (cm):</p>
                <p id="detailDiameterCm" class="font-semibold"></p>
            </div>
            <div class="md:col-span-2">
                <p class="text-sm font-medium text-gray-500">Remarks:</p>
                <p id="detailRemarks" class="font-semibold"></p>
            </div>
            <div class="md:col-span-2">
                <p class="text-sm font-medium text-gray-500">Status:</p>
                <p id="detailStatus" class="font-semibold"></p>
            </div>
        </div>
        <!-- Actions -->
        <div class="flex justify-end space-x-3 bg-gray-50 px-6 py-4 border-t border-gray-200">
            <button id="closeDetailsButton" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400">Close</button>
        </div>
    </div>
</div>


<!-- Modal for Delete Confirmation -->
<div id="deleteConfirmationModal" class="modal-overlay hidden">
    <div class="modal-content">
        <div class="flex justify-between items-center border-b border-gray-200 pb-3 mb-4">
            <h2 class="text-lg font-semibold text-gray-800">Confirm Deletion</h2>
            <button id="closeDeleteModalButton" class="text-gray-500 hover:text-gray-700">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>
        <div class="p-4">
            <p class="text-gray-700 mb-4">Are you sure you want to delete this record? This action cannot be undone.</p>
            <div class="flex justify-end space-x-3">
                <button id="cancelDeleteButton" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400">Cancel</button>
                <button id="confirmDeleteButton" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">Delete</button>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const addInwardButton = document.getElementById('addInwardButton');
        const inwardEntryModal = document.getElementById('inwardEntryModal');
        const closeModalButton = document.getElementById('closeModalButton');
        const newInwardForm = document.getElementById('newInwardForm');
        const inwardRecordsTableBody = document.querySelector('#inwardRecordsTable tbody');
        const totalInwardCount = document.getElementById('totalInwardCount');
        const processedCount = document.getElementById('processedCount');
        const pendingCount = document.getElementById('pendingCount');
        const invalidCount = document.getElementById('invalidCount');
        const totalEntries = document.getElementById('totalEntries');

        // Elements for the View Details Modal
        const viewDetailsModal = document.getElementById('viewDetailsModal');
        const closeViewModalButton = document.getElementById('closeViewModalButton');
        const closeDetailsButton = document.getElementById('closeDetailsButton');
        const detailInwardDate = document.getElementById('detailInwardDate');
        const detailReelCode = document.getElementById('detailReelCode');
        const detailWeight = document.getElementById('detailWeight');
        const detailZone = document.getElementById('detailZone');
        const detailSupplier = document.getElementById('detailSupplier');
        const detailMaterialType = document.getElementById('detailMaterialType');
        const detailWidthCm = document.getElementById('detailWidthCm');
        const detailDiameterCm = document.getElementById('detailDiameterCm');
        const detailRemarks = document.getElementById('detailRemarks');
        const detailStatus = document.getElementById('detailStatus'); // New Status Detail Element

        // Elements for Delete Confirmation Modal
        const deleteConfirmationModal = document.getElementById('deleteConfirmationModal');
        const closeDeleteModalButton = document.getElementById('closeDeleteModalButton');
        const cancelDeleteButton = document.getElementById('cancelDeleteButton');
        const confirmDeleteButton = document.getElementById('confirmDeleteButton');
        let recordToDeleteId = null; // To store the ID of the record to be deleted

        // Supplier & Material Type Searchable Dropdown Elements
        const supplierSearchInput = document.getElementById('supplierSearchInput');
        const supplierHiddenInput = document.getElementById('supplierHiddenInput');
        const supplierOptionsDiv = document.getElementById('supplierOptions');

        const materialTypeSearchInput = document.getElementById('materialTypeSearchInput');
        const materialTypeHiddenInput = document.getElementById('materialTypeHiddenInput');
        const materialTypeOptionsDiv = document.getElementById('materialTypeOptions');

        // Form fields for editing
        const inwardDateModal = document.getElementById('inwardDateModal');
        const reelCodeModal = document.getElementById('reelCodeModal');
        const weightModal = document.getElementById('weightModal');
        const zoneModal = document.getElementById('zoneModal');
        const widthCmModal = document.getElementById('widthCmModal');
        const diameterCmModal = document.getElementById('diameterCmModal');
        const remarksModal = document.getElementById('remarksModal');
        const inwardModalTitle = document.getElementById('inwardModalTitle');
        const submitInwardFormButton = document.getElementById('submitInwardFormButton');


        // Dummy data for demonstration purposes
        let inwardRecords = [
            { id: 1, inwardDate: '2023-01-15', reelCode: 'R001', weight: 1200, zone: 'Cutting', supplier: 'Supplier A', materialType: 'Kraft Paper', remarks: 'Good quality', status: 'Processed' },
            { id: 2, inwardDate: '2023-01-16', reelCode: 'R002', weight: 1500, zone: 'Wrapping', supplier: 'Supplier B', materialType: 'Duplex Board', remarks: 'Slight damage', status: 'Pending' },
            { id: 3, inwardDate: '2023-01-17', reelCode: 'R003', weight: 1100, zone: 'Cutting', supplier: 'Supplier A', materialType: 'Kraft Paper', remarks: '', status: 'In-Valid' },
            { id: 4, inwardDate: '2023-01-18', reelCode: 'R004', weight: 1350, zone: 'Wrapping', supplier: 'Supplier C', materialType: 'Art Paper', remarks: 'Urgent', status: 'Processed' },
            { id: 5, inwardDate: '2023-01-19', reelCode: 'R005', weight: 1000, zone: 'Cutting', supplier: 'Supplier B', materialType: 'Duplex Board', remarks: '', status: 'Pending' }
        ];

        let suppliers = Array.from(new Set(inwardRecords.map(record => record.supplier)));
        let materialTypes = Array.from(new Set(inwardRecords.map(record => record.materialType)));

        // Function to populate dropdown options
        function populateOptions(inputElement, optionsDiv, hiddenInputElement, dataArray) {
            optionsDiv.innerHTML = ''; // Clear existing options

            // Filter options based on input value
            const searchTerm = inputElement.value.toLowerCase();
            const filteredData = dataArray.filter(item =>
                item.toLowerCase().includes(searchTerm)
            );

            if (filteredData.length === 0 && searchTerm !== '') {
                // Option to add new if no match found and input is not empty
                const addNewOption = document.createElement('div');
                addNewOption.classList.add('custom-select-option', 'add-new');
                addNewOption.textContent = `Add "${inputElement.value}"`;
                addNewOption.addEventListener('click', () => {
                    hiddenInputElement.value = inputElement.value;
                    inputElement.value = inputElement.value;
                    optionsDiv.style.display = 'none';
                    if (inputElement.id === 'supplierSearchInput' && !suppliers.includes(inputElement.value)) {
                        suppliers.push(inputElement.value);
                    } else if (inputElement.id === 'materialTypeSearchInput' && !materialTypes.includes(inputElement.value)) {
                        materialTypes.push(inputElement.value);
                    }
                });
                optionsDiv.appendChild(addNewOption);
            } else {
                filteredData.forEach(item => {
                    const option = document.createElement('div');
                    option.classList.add('custom-select-option');
                    option.textContent = item;
                    option.addEventListener('click', () => {
                        inputElement.value = item;
                        hiddenInputElement.value = item;
                        optionsDiv.style.display = 'none';
                    });
                    optionsDiv.appendChild(option);
                });
            }

            // Show options if there's an input or filtered data
            optionsDiv.style.display = (searchTerm !== '' || filteredData.length > 0) ? 'block' : 'none';
        }

        // Event listeners for Supplier Searchable Dropdown
        if (supplierSearchInput) {
            supplierSearchInput.addEventListener('input', () => {
                populateOptions(supplierSearchInput, supplierOptionsDiv, supplierHiddenInput, suppliers);
            });
            supplierSearchInput.addEventListener('focus', () => {
                populateOptions(supplierSearchInput, supplierOptionsDiv, supplierHiddenInput, suppliers);
            });
            supplierSearchInput.addEventListener('blur', (event) => {
                // Delay hiding to allow click event on options to fire
                setTimeout(() => {
                    if (!supplierOptionsDiv.contains(event.relatedTarget)) {
                        supplierOptionsDiv.style.display = 'none';
                    }
                }, 100);
            });
            supplierOptionsDiv.addEventListener('mousedown', (event) => {
                // Prevent input blur when clicking on an option
                event.preventDefault();
            });
        }

        // Event listeners for Material Type Searchable Dropdown
        if (materialTypeSearchInput) {
            materialTypeSearchInput.addEventListener('input', () => {
                populateOptions(materialTypeSearchInput, materialTypeOptionsDiv, materialTypeHiddenInput, materialTypes);
            });
            materialTypeSearchInput.addEventListener('focus', () => {
                populateOptions(materialTypeSearchInput, materialTypeOptionsDiv, materialTypeHiddenInput, materialTypes);
            });
            materialTypeSearchInput.addEventListener('blur', (event) => {
                // Delay hiding to allow click event on options to fire
                setTimeout(() => {
                    if (!materialTypeOptionsDiv.contains(event.relatedTarget)) {
                        materialTypeOptionsDiv.style.display = 'none';
                    }
                }, 100);
            });
            materialTypeOptionsDiv.addEventListener('mousedown', (event) => {
                // Prevent input blur when clicking on an option
                event.preventDefault();
            });
        }

        // Function to render the table rows
        function renderTable() {
            inwardRecordsTableBody.innerHTML = ''; // Clear existing rows
            let processed = 0;
            let pending = 0;
            let invalid = 0;

            inwardRecords.forEach(record => {
                const row = inwardRecordsTableBody.insertRow();
                row.classList.add('hover:bg-gray-50');

                row.innerHTML = `
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">${record.inwardDate}</td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">${record.reelCode}</td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">${record.weight}</td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">${record.zone}</td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">${record.supplier}</td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">${record.materialType}</td>
                    <td class="px-4 py-3 text-sm text-gray-900">${record.remarks || '-'}</td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full
                            ${record.status === 'Processed' ? 'bg-green-100 text-green-800' : ''}
                            ${record.status === 'Pending' ? 'bg-yellow-100 text-yellow-800' : ''}
                            ${record.status === 'In-Valid' ? 'bg-red-100 text-red-800' : ''}">
                            ${record.status}
                        </span>
                    </td>
                    <td class="px-4 py-3 whitespace-nowrap text-center text-sm font-medium">
                        <div class="flex items-center justify-center space-x-2">
                            <button class="text-blue-600 hover:text-blue-900 view-button" data-id="${record.id}" title="View Details">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="text-indigo-600 hover:text-indigo-900 edit-button" data-id="${record.id}" title="Edit Record">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="text-red-600 hover:text-red-900 delete-button" data-id="${record.id}" title="Delete Record">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </div>
                    </td>
                `;

                // Update counts based on status
                if (record.status === 'Processed') {
                    processed++;
                } else if (record.status === 'Pending') {
                    pending++;
                } else if (record.status === 'In-Valid') {
                    invalid++;
                }
            });

            // Update dashboard cards
            totalInwardCount.textContent = `${inwardRecords.length} Reels`;
            processedCount.textContent = `${processed} Reels`;
            pendingCount.textContent = `${pending} Reels`;
            invalidCount.textContent = `${invalid} Reels`;
            totalEntries.textContent = inwardRecords.length;

            // Add event listeners for view, edit, and delete buttons
            document.querySelectorAll('.view-button').forEach(button => {
                button.addEventListener('click', function () {
                    const id = parseInt(this.dataset.id);
                    viewRecordDetails(id);
                });
            });

            document.querySelectorAll('.edit-button').forEach(button => {
                button.addEventListener('click', function () {
                    const id = parseInt(this.dataset.id);
                    editRecord(id);
                });
            });

            document.querySelectorAll('.delete-button').forEach(button => {
                button.addEventListener('click', function () {
                    const id = parseInt(this.dataset.id);
                    showDeleteConfirmation(id);
                });
            });
        }

        // Function to show the modal for new entry or edit
        if (addInwardButton) {
            addInwardButton.addEventListener('click', function () {
                inwardModalTitle.textContent = 'New Inward Entry';
                submitInwardFormButton.innerHTML = '<i class="fas fa-plus mr-2"></i> Create Entry';
                newInwardForm.reset(); // Clear form fields
                newInwardForm.dataset.editingId = ''; // Clear editing ID
                const today = new Date().toISOString().split('T')[0];
                inwardDateModal.value = today; // Set current date
                inwardEntryModal.classList.remove('hidden');
            });
        }

        // Function to close the modal
        if (closeModalButton) {
            closeModalButton.addEventListener('click', function () {
                inwardEntryModal.classList.add('hidden');
            });
        }

        // Close modal when clicking outside
        if (inwardEntryModal) {
            inwardEntryModal.addEventListener('click', function (event) {
                if (event.target === inwardEntryModal) {
                    inwardEntryModal.classList.add('hidden');
                }
            });
        }

        // Handle form submission
        if (newInwardForm) {
            newInwardForm.addEventListener('submit', function (event) {
                event.preventDefault(); // Prevent default form submission

                const editingId = newInwardForm.dataset.editingId;
                const newRecord = {
                    inwardDate: inwardDateModal.value,
                    reelCode: reelCodeModal.value,
                    weight: parseFloat(weightModal.value),
                    zone: zoneModal.value,
                    supplier: supplierHiddenInput.value, // Use hidden input for supplier
                    materialType: materialTypeHiddenInput.value, // Use hidden input for material type
                    widthCm: parseFloat(widthCmModal.value) || null,
                    diameterCm: parseFloat(diameterCmModal.value) || null,
                    remarks: remarksModal.value,
                    status: 'Pending' // Default status for new entries
                };

                if (editingId) {
                    // Update existing record
                    const index = inwardRecords.findIndex(record => record.id === parseInt(editingId));
                    if (index !== -1) {
                        inwardRecords[index] = { ...inwardRecords[index], ...newRecord };
                    }
                } else {
                    // Add new record
                    newRecord.id = inwardRecords.length ? Math.max(...inwardRecords.map(r => r.id)) + 1 : 1;
                    inwardRecords.push(newRecord);
                }

                // Update suppliers and material types lists
                if (!suppliers.includes(newRecord.supplier)) {
                    suppliers.push(newRecord.supplier);
                }
                if (!materialTypes.includes(newRecord.materialType)) {
                    materialTypes.push(newRecord.materialType);
                }

                renderTable(); // Re-render the table
                inwardEntryModal.classList.add('hidden'); // Hide the modal
            });
        }

        // Function to populate and show the view details modal
        function viewRecordDetails(id) {
            const record = inwardRecords.find(r => r.id === id);
            if (record) {
                detailInwardDate.textContent = record.inwardDate;
                detailReelCode.textContent = record.reelCode;
                detailWeight.textContent = `${record.weight} kg`;
                detailZone.textContent = record.zone;
                detailSupplier.textContent = record.supplier;
                detailMaterialType.textContent = record.materialType;
                detailWidthCm.textContent = record.widthCm ? `${record.widthCm} cm` : '-';
                detailDiameterCm.textContent = record.diameterCm ? `${record.diameterCm} cm` : '-';
                detailRemarks.textContent = record.remarks || 'No remarks';
                detailStatus.textContent = record.status;
                viewDetailsModal.classList.remove('hidden');
            }
        }

        // Function to populate and show the edit modal
        function editRecord(id) {
            const record = inwardRecords.find(r => r.id === id);
            if (record) {
                inwardModalTitle.textContent = 'Edit Inward Entry';
                submitInwardFormButton.innerHTML = '<i class="fas fa-save mr-2"></i> Save Changes';
                newInwardForm.dataset.editingId = id; // Store the ID of the record being edited

                inwardDateModal.value = record.inwardDate;
                reelCodeModal.value = record.reelCode;
                weightModal.value = record.weight;
                zoneModal.value = record.zone;
                supplierSearchInput.value = record.supplier; // Set display value
                supplierHiddenInput.value = record.supplier; // Set hidden value
                materialTypeSearchInput.value = record.materialType; // Set display value
                materialTypeHiddenInput.value = record.materialType; // Set hidden value
                widthCmModal.value = record.widthCm;
                diameterCmModal.value = record.diameterCm;
                remarksModal.value = record.remarks;

                inwardEntryModal.classList.remove('hidden');
            }
        }

        // Close view details modal
        if (closeViewModalButton) {
            closeViewModalButton.addEventListener('click', function () {
                viewDetailsModal.classList.add('hidden');
            });
        }
        if (closeDetailsButton) {
            closeDetailsButton.addEventListener('click', function () {
                viewDetailsModal.classList.add('hidden');
            });
        }
        if (viewDetailsModal) {
            viewDetailsModal.addEventListener('click', function (event) {
                if (event.target === viewDetailsModal) {
                    viewDetailsModal.classList.add('hidden');
                }
            });
        }

        // Show delete confirmation modal
        function showDeleteConfirmation(id) {
            recordToDeleteId = id;
            deleteConfirmationModal.classList.remove('hidden');
        }

        // Handle delete confirmation
        if (confirmDeleteButton) {
            confirmDeleteButton.addEventListener('click', function () {
                if (recordToDeleteId !== null) {
                    inwardRecords = inwardRecords.filter(record => record.id !== recordToDeleteId);
                    renderTable();
                    deleteConfirmationModal.classList.add('hidden');
                    recordToDeleteId = null; // Reset
                }
            });
        }

        // Cancel delete
        if (cancelDeleteButton) {
            cancelDeleteButton.addEventListener('click', function () {
                deleteConfirmationModal.classList.add('hidden');
                recordToDeleteId = null; // Reset
            });
        }

        // Close delete modal
        if (closeDeleteModalButton) {
            closeDeleteModalButton.addEventListener('click', function () {
                deleteConfirmationModal.classList.add('hidden');
                recordToDeleteId = null; // Reset
            });
        }

        // Close delete modal when clicking outside
        if (deleteConfirmationModal) {
            deleteConfirmationModal.addEventListener('click', function (event) {
                if (event.target === deleteConfirmationModal) {
                    deleteConfirmationModal.classList.add('hidden');
                }
            });
        }


        // Removed mobile menu toggle functionality
        // const mobileMenuButton = document.querySelector('.mobile-menu-button');
        // const mobileMenu = document.querySelector('.mobile-menu');

        // if (mobileMenuButton) {
        //     mobileMenuButton.addEventListener('click', function() {
        //         mobileMenu.classList.toggle('active');
        //     });
        // }

        // User menu toggle functionality
        const userMenuBtn = document.getElementById('userMenuBtn');
        const userMenu = document.getElementById('userMenu');

        if (userMenuBtn) {
            userMenuBtn.addEventListener('click', function() {
                userMenu.classList.toggle('hidden');
            });

            // Close user menu if clicked outside
            document.addEventListener('click', function(event) {
                if (!userMenuBtn.contains(event.target) && !userMenu.contains(event.target)) {
                    userMenu.classList.add('hidden');
                }
            });
        }

        const header = document.querySelector('.header-fixed'); // Updated to target new header class
        window.addEventListener('scroll', function() {
            if (window.scrollY > 0) {
                header.classList.add('shadow-scroll');
            } else {
                header.classList.remove('shadow-scroll');
            }
        });

        // Highlight active navigation item
        function highlightActiveNavItem() {
            const currentPath = window.location.pathname.split('/').pop(); // Get filename (e.g., "inward.html")
            const navLinks = document.querySelectorAll('.nav-link, .mobile-nav-link');

            navLinks.forEach(link => {
                const linkPath = link.getAttribute('href');
                if (linkPath === currentPath) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active'); // Ensure other links are not active
                }
            });
        }

        // Initial render of the table when the page loads
        renderTable();
        highlightActiveNavItem(); // Call this function on page load
    });
</script>
</body>
</html>
